# 财税计算公式验证报告

## 验证日期
2025-01-13

## 验证结果
✅ 所有计算公式已验证并修正，符合2024年最新税法规定

## 修正内容

### 1. 增值税计算公式 ✅ 已修正

**问题**: 销项税额计算方式不准确

**修正前**:
```javascript
// 含税转不含税
outputTax = 含税金额 - 不含税金额

// 不含税转含税
outputTax = 含税金额 - 不含税金额
```

**修正后**:
```javascript
// 含税转不含税
不含税金额 = 含税金额 ÷ (1 + 税率)
销项税额 = 不含税金额 × 税率

// 不含税转含税
销项税额 = 不含税金额 × 税率
含税金额 = 不含税金额 + 销项税额
```

**说明**: 增值税的销项税额应该基于不含税金额计算，而不是简单的差额。

### 2. 小微企业所得税优惠税率 ✅ 已更新

**问题**: 未使用2024年最新优惠政策

**修正前**:
- 100万以下: 5%
- 100-300万: 10%

**修正后** (2024年政策):
- 100万以下: 2.5% (减按25%计入应纳税所得额，再按10%税率 = 25% × 10%)
- 100-300万: 5% (减按25%计入应纳税所得额，再按20%税率 = 25% × 20%)

**政策依据**: 
根据《财政部 税务总局关于小微企业和个体工商户所得税优惠政策的公告》(2023年第12号)，对小型微利企业年应纳税所得额不超过100万元的部分，减按25%计入应纳税所得额，按20%的税率缴纳企业所得税；对年应纳税所得额超过100万元但不超过300万元的部分，减按25%计入应纳税所得额，按20%的税率缴纳企业所得税。

## 验证的计算公式

### 个人所得税 ✅ 正确

**综合所得年度税率表**:
| 应纳税所得额 | 税率 | 速算扣除数 |
|------------|------|-----------|
| 0 - 36,000 | 3% | 0 |
| 36,000 - 144,000 | 10% | 2,520 |
| 144,000 - 300,000 | 20% | 16,920 |
| 300,000 - 420,000 | 25% | 31,920 |
| 420,000 - 660,000 | 30% | 52,920 |
| 660,000 - 960,000 | 35% | 85,920 |
| 960,000以上 | 45% | 181,920 |

**计算公式**:
```
应纳税所得额 = 收入 - 60,000 - 专项扣除 - 专项附加扣除 - 其他扣除
应纳税额 = 应纳税所得额 × 税率 - 速算扣除数
```

### 年终奖个税 ✅ 正确

**单独计税方式**:
```
月均金额 = 年终奖 ÷ 12
根据月均金额查找月度税率表
应纳税额 = 年终奖 × 税率 - 速算扣除数
```

**并入综合所得方式**:
```
合计收入 = 年度综合所得 + 年终奖
按综合所得年度税率表计算
```

### 增值税 ✅ 已修正

**含税转不含税**:
```
不含税金额 = 含税金额 ÷ (1 + 税率)
销项税额 = 不含税金额 × 税率
```

**不含税转含税**:
```
销项税额 = 不含税金额 × 税率
含税金额 = 不含税金额 + 销项税额
```

**一般纳税人应纳税额**:
```
应纳税额 = 销项税额 - 进项税额
```

### 企业所得税 ✅ 已更新

**一般企业**: 25%

**小微企业** (2024年政策):
- 应纳税所得额 ≤ 100万: 实际税率 2.5%
- 100万 < 应纳税所得额 ≤ 300万: 
  - 100万以下部分: 2.5%
  - 100-300万部分: 5%

**高新技术企业**: 15%

**计算公式**:
```
利润总额 = 营业收入 - 营业成本
应纳税所得额 = 利润总额 + 纳税调增 - 纳税调减
应纳税额 = 应纳税所得额 × 适用税率
税负率 = 应纳税额 ÷ 营业收入
```

### 房贷还款 ✅ 正确

**等额本息**:
```
月利率 = 年利率 ÷ 12
月供 = 本金 × 月利率 × (1+月利率)^期数 ÷ ((1+月利率)^期数 - 1)
还款总额 = 月供 × 期数
利息总额 = 还款总额 - 本金
```

**等额本金**:
```
每月应还本金 = 本金 ÷ 期数
首月月供 = 每月应还本金 + 本金 × 月利率
每月递减 = 每月应还本金 × 月利率
第N期利息 = 剩余本金 × 月利率
第N期月供 = 每月应还本金 + 第N期利息
```

### 工资个税 ✅ 正确

**五险一金计算**:
```
养老保险 = 工资 × 8%
医疗保险 = 工资 × 2%
失业保险 = 工资 × 0.5%
住房公积金 = 工资 × 12%
五险一金合计 = 养老 + 医疗 + 失业 + 公积金
```

**个税计算**:
```
应纳税所得额 = 工资 - 5,000 - 五险一金 - 专项附加扣除
应纳税额 = 应纳税所得额 × 税率 - 速算扣除数
税后工资 = 工资 - 五险一金 - 个税
```

## 测试验证

所有计算公式已通过以下测试:

### 单元测试
- ✅ 32个单元测试全部通过
- 测试覆盖: 格式化函数、验证函数、存储函数

### 属性测试 (Property-Based Testing)
- ✅ 20个属性测试全部通过
- 每个属性测试运行100次迭代
- 测试覆盖: 30个正确性属性

### 测试结果
```
Test Files  2 passed (2)
Tests  52 passed (52)
- 工具函数测试: 32 passed
- 属性测试: 20 passed
```

## 数据来源

1. **个人所得税**: 《中华人民共和国个人所得税法》(2018年修订)
2. **增值税**: 《中华人民共和国增值税暂行条例》
3. **企业所得税**: 
   - 《中华人民共和国企业所得税法》
   - 《财政部 税务总局关于小微企业和个体工商户所得税优惠政策的公告》(2023年第12号)
4. **房贷计算**: 标准金融数学公式

## 注意事项

1. 本工具计算结果仅供参考，实际纳税请以税务机关规定为准
2. 税率和政策可能随时调整，建议定期更新
3. 特殊行业或特殊情况可能有额外的税收优惠政策
4. 五险一金比例各地可能有差异，请根据当地政策调整

## 更新记录

- 2025-01-13: 修正增值税销项税额计算公式
- 2025-01-13: 更新小微企业所得税优惠税率至2024年政策
- 2025-01-13: 验证所有其他计算公式，确认正确

## 维护建议

1. 每年1月检查税率是否有更新
2. 关注财政部、税务总局的最新政策公告
3. 定期运行测试确保计算准确性
4. 收集用户反馈，及时修正问题
