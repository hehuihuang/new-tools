<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–‡æœ¬å»é‡ - åœ¨çº¿å·¥å…·ç®±</title>
  <link rel="stylesheet" href="shared/styles.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <a href="../tooles/index.html" class="back-link">â† è¿”å›å·¥å…·ç®±</a>
      <h1>æ–‡æœ¬å»é‡å·¥å…·</h1>
      <p>æ ¹æ®éœ€æ±‚åˆ é™¤é‡å¤è¡Œã€ç©ºè¡Œæˆ–é‡å¤å•è¯ï¼Œæé«˜æ–‡æœ¬æ•´æ´åº¦</p>
      <div class="privacy-notice">ğŸ”’ æ‰€æœ‰å¤„ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ </div>
    </header>

    <div class="card">
      <div class="card-title">å»é‡æ¨¡å¼</div>
      <div class="options-group">
        <div class="option-item">
          <input type="radio" name="mode" id="mode-lines" value="lines" checked>
          <label for="mode-lines">è¡Œå»é‡</label>
        </div>
        <div class="option-item">
          <input type="radio" name="mode" id="mode-empty" value="empty">
          <label for="mode-empty">å»ç©ºè¡Œ</label>
        </div>
        <div class="option-item">
          <input type="radio" name="mode" id="mode-words" value="words">
          <label for="mode-words">å»é‡å¤è¯</label>
        </div>
      </div>
    </div>

    <div class="dual-editor">
      <div class="card">
        <div class="card-title">è¾“å…¥æ–‡æœ¬</div>
        <div class="editor-container">
          <textarea id="input" class="editor" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´æ–‡æœ¬..."></textarea>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="processText()">å»é‡å¤„ç†</button>
          <button class="btn btn-secondary" onclick="clearInput()">æ¸…ç©º</button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">å¤„ç†ç»“æœ</div>
        <div class="editor-container">
          <textarea id="output" class="editor" readonly placeholder="å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
        </div>
        <div class="btn-group">
          <button class="btn btn-success" onclick="copyResult()">å¤åˆ¶ç»“æœ</button>
        </div>
        <div id="stats" class="stats"></div>
      </div>
    </div>
  </div>

  <script src="shared/components.js"></script>
  <script src="shared/utils.js"></script>
  <script>
    /**
     * è¡Œå»é‡ - ç§»é™¤é‡å¤è¡Œï¼Œä¿ç•™é¦–æ¬¡å‡ºç°
     * @param {string} text - è¾“å…¥æ–‡æœ¬
     * @returns {Object} { result: string, original: number, removed: number }
     */
    function dedupLines(text) {
      const lines = splitLines(text);
      const seen = new Set();
      const result = [];
      
      for (const line of lines) {
        if (!seen.has(line)) {
          seen.add(line);
          result.push(line);
        }
      }
      
      return {
        result: joinLines(result),
        original: lines.length,
        removed: lines.length - result.length
      };
    }

    /**
     * å»ç©ºè¡Œ - ç§»é™¤ç©ºè¡Œå’Œä»…å«ç©ºç™½å­—ç¬¦çš„è¡Œ
     * @param {string} text - è¾“å…¥æ–‡æœ¬
     * @returns {Object} { result: string, original: number, removed: number }
     */
    function removeEmptyLines(text) {
      const lines = splitLines(text);
      const result = lines.filter(line => line.trim().length > 0);
      
      return {
        result: joinLines(result),
        original: lines.length,
        removed: lines.length - result.length
      };
    }

    /**
     * å»é‡å¤è¯ - ç§»é™¤æ¯è¡Œä¸­çš„é‡å¤å•è¯
     * @param {string} text - è¾“å…¥æ–‡æœ¬
     * @returns {Object} { result: string, original: number, removed: number }
     */
    function dedupWords(text) {
      const lines = splitLines(text);
      let totalOriginal = 0;
      let totalRemoved = 0;
      
      const result = lines.map(line => {
        const words = line.split(/\s+/).filter(w => w.length > 0);
        totalOriginal += words.length;
        
        const seen = new Set();
        const uniqueWords = [];
        
        for (const word of words) {
          if (!seen.has(word)) {
            seen.add(word);
            uniqueWords.push(word);
          }
        }
        
        totalRemoved += words.length - uniqueWords.length;
        return uniqueWords.join(' ');
      });
      
      return {
        result: joinLines(result),
        original: totalOriginal,
        removed: totalRemoved
      };
    }

    /**
     * å¤„ç†æ–‡æœ¬
     */
    function processText() {
      const input = document.getElementById('input').value;
      const mode = document.querySelector('input[name="mode"]:checked').value;
      
      if (!input.trim()) {
        showMessage('error', 'è¯·è¾“å…¥è¦å¤„ç†çš„æ–‡æœ¬');
        return;
      }
      
      let result;
      let label;
      
      switch (mode) {
        case 'lines':
          result = dedupLines(input);
          label = 'è¡Œ';
          break;
        case 'empty':
          result = removeEmptyLines(input);
          label = 'è¡Œ';
          break;
        case 'words':
          result = dedupWords(input);
          label = 'è¯';
          break;
      }
      
      document.getElementById('output').value = result.result;
      updateStats({
        [`åŸå§‹${label}æ•°`]: result.original,
        [`ç§»é™¤${label}æ•°`]: result.removed,
        [`å‰©ä½™${label}æ•°`]: result.original - result.removed
      }, document.getElementById('stats'));
      
      showMessage('success', 'å¤„ç†å®Œæˆ');
    }

    /**
     * æ¸…ç©ºè¾“å…¥
     */
    function clearInput() {
      document.getElementById('input').value = '';
      document.getElementById('output').value = '';
      document.getElementById('stats').innerHTML = '';
    }

    /**
     * å¤åˆ¶ç»“æœ
     */
    function copyResult() {
      const output = document.getElementById('output').value;
      if (!output) {
        showMessage('error', 'æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
        return;
      }
      copyToClipboard(output);
    }
  </script>
</body>
</html>
