<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–‡æœ¬æ¸…ç† - åœ¨çº¿å·¥å…·ç®±</title>
  <link rel="stylesheet" href="shared/styles.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <a href="../tooles/index.html" class="back-link">â† è¿”å›å·¥å…·ç®±</a>
      <h1>æ–‡æœ¬æ¸…ç†å·¥å…·</h1>
      <p>å»é™¤å¤šä½™ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦ã€HTMLæ ‡ç­¾ï¼Œå¿«é€Ÿæ¸…ç†æ–‡æœ¬æ ¼å¼</p>
      <div class="privacy-notice">ğŸ”’ æ‰€æœ‰å¤„ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ </div>
    </header>

    <div class="card">
      <div class="card-title">æ¸…ç†é€‰é¡¹</div>
      <div style="display: grid; gap: 10px;">
        <label style="display: flex; align-items: center; gap: 8px;">
          <input type="checkbox" id="opt-trim" checked>
          <span>å»é™¤é¦–å°¾ç©ºæ ¼</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px;">
          <input type="checkbox" id="opt-collapse" checked>
          <span>å»é™¤å¤šä½™ç©ºæ ¼ï¼ˆåˆå¹¶è¿ç»­ç©ºæ ¼ï¼‰</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px;">
          <input type="checkbox" id="opt-special">
          <span>å»é™¤ç‰¹æ®Šå­—ç¬¦ï¼ˆä¿ç•™å­—æ¯æ•°å­—å’Œå¸¸ç”¨æ ‡ç‚¹ï¼‰</span>
        </label>
        <label style="display: flex; align-items: center; gap: 8px;">
          <input type="checkbox" id="opt-html">
          <span>å»é™¤HTMLæ ‡ç­¾</span>
        </label>
      </div>
    </div>

    <div class="dual-editor">
      <div class="card">
        <div class="card-title">è¾“å…¥æ–‡æœ¬</div>
        <div class="editor-container">
          <textarea id="input" class="editor" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´æ–‡æœ¬..."></textarea>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="cleanText()">æ¸…ç†</button>
          <button class="btn btn-secondary" onclick="clearInput()">æ¸…ç©º</button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">æ¸…ç†ç»“æœ</div>
        <div class="editor-container">
          <textarea id="output" class="editor" readonly placeholder="æ¸…ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
        </div>
        <div class="btn-group">
          <button class="btn btn-success" onclick="copyResult()">å¤åˆ¶ç»“æœ</button>
        </div>
        <div id="stats" class="stats"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import { showMessage, copyToClipboard, updateStats } from './shared/components.js';

    window.showMessage = showMessage;
    window.copyToClipboard = copyToClipboard;
    window.updateStats = updateStats;

    /**
     * å»é™¤é¦–å°¾ç©ºæ ¼
     */
    function trimLines(text) {
      return text.split(/\r?\n/).map(line => line.trim()).join('\n');
    }

    /**
     * åˆå¹¶å¤šä½™ç©ºæ ¼
     */
    function collapseSpaces(text) {
      return text.replace(/ {2,}/g, ' ');
    }

    /**
     * å»é™¤ç‰¹æ®Šå­—ç¬¦
     */
    function removeSpecialChars(text) {
      // ä¿ç•™å­—æ¯ã€æ•°å­—ã€ä¸­æ–‡ã€å¸¸ç”¨æ ‡ç‚¹å’Œç©ºç™½å­—ç¬¦
      return text.replace(/[^\w\s\u4e00-\u9fa5.,!?;:'"()\-]/g, '');
    }

    /**
     * å»é™¤HTMLæ ‡ç­¾
     */
    function stripHtmlTags(text) {
      return text.replace(/<[^>]+>/g, '');
    }

    /**
     * æ¸…ç†æ–‡æœ¬
     */
    window.cleanText = function() {
      const input = document.getElementById('input').value;
      
      if (!input.trim()) {
        showMessage('error', 'è¯·è¾“å…¥è¦æ¸…ç†çš„æ–‡æœ¬');
        return;
      }
      
      let result = input;
      const operations = [];
      
      // æŒ‰é¡ºåºåº”ç”¨æ¸…ç†æ“ä½œ
      if (document.getElementById('opt-html').checked) {
        result = stripHtmlTags(result);
        operations.push('å»é™¤HTMLæ ‡ç­¾');
      }
      
      if (document.getElementById('opt-special').checked) {
        result = removeSpecialChars(result);
        operations.push('å»é™¤ç‰¹æ®Šå­—ç¬¦');
      }
      
      if (document.getElementById('opt-collapse').checked) {
        result = collapseSpaces(result);
        operations.push('åˆå¹¶ç©ºæ ¼');
      }
      
      if (document.getElementById('opt-trim').checked) {
        result = trimLines(result);
        operations.push('å»é™¤é¦–å°¾ç©ºæ ¼');
      }
      
      if (operations.length === 0) {
        showMessage('error', 'è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ¸…ç†é€‰é¡¹');
        return;
      }
      
      document.getElementById('output').value = result;
      updateStats({
        'åŸå§‹é•¿åº¦': input.length,
        'æ¸…ç†åé•¿åº¦': result.length,
        'å‡å°‘å­—ç¬¦': input.length - result.length,
        'åº”ç”¨æ“ä½œ': operations.join('ã€')
      }, document.getElementById('stats'));
      
      showMessage('success', 'æ¸…ç†å®Œæˆ');
    };

    window.clearInput = function() {
      document.getElementById('input').value = '';
      document.getElementById('output').value = '';
      document.getElementById('stats').innerHTML = '';
    };

    window.copyResult = function() {
      const output = document.getElementById('output').value;
      if (!output) {
        showMessage('error', 'æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
        return;
      }
      copyToClipboard(output);
    };

    // å¯¼å‡ºä¾›æµ‹è¯•ä½¿ç”¨
    window.trimLines = trimLines;
    window.collapseSpaces = collapseSpaces;
    window.removeSpecialChars = removeSpecialChars;
    window.stripHtmlTags = stripHtmlTags;
  </script>
</body>
</html>
