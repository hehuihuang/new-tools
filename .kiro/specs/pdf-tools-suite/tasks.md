# 实施计划

- [x] 1. 设置项目结构和共享资源





  - 创建 pdf-tools 文件夹结构
  - 创建共享的 CSS 样式文件（统一视觉风格）
  - 创建共享的 JavaScript 工具库（utils.js）
  - 引入 PDF.js、pdf-lib、JSZip 库的 CDN 链接
  - _需求: 9.3, 10.1_

- [x] 1.1 编写共享工具函数的单元测试


  - 测试 parsePageRange() 函数
  - 测试 formatFileSize() 函数
  - 测试 downloadFile() 函数
  - _需求: 3.2_

- [x] 2. 实现共享组件


- [x] 2.1 实现 FileUploader 组件


  - 编写文件选择和验证逻辑
  - 实现文件大小限制（50MB）
  - 实现文件类型验证
  - 实现 readAsArrayBuffer 方法
  - _需求: 1.1, 10.1_

- [x] 2.2 实现 PDFViewer 组件

  - 集成 PDF.js 进行 PDF 渲染
  - 实现页面导航功能（上一页、下一页、跳转）
  - 实现缩放功能（放大、缩小、适应页面）
  - 实现页面切换时的状态清理
  - _需求: 1.1, 1.2, 1.3, 1.5_

- [x] 2.3 编写 PDFViewer 组件的属性测试


  - **属性 2: 多页导航控件存在性**
  - **验证需求: 1.2**

- [x] 2.4 编写 PDFViewer 组件的属性测试


  - **属性 3: 缩放控件功能性**
  - **验证需求: 1.3**

- [x] 2.5 实现 ProgressIndicator 组件

  - 编写进度显示 UI
  - 实现 show、update、hide 方法
  - _需求: 2.3, 3.4, 5.4_

- [x] 2.6 实现通用工具函数（Utils）

  - 实现 downloadFile() 函数
  - 实现 formatFileSize() 函数
  - 实现 parsePageRange() 函数
  - 实现 showError() 和 showSuccess() 函数
  - _需求: 2.4, 3.2, 8.1_

- [x] 2.7 编写页面范围解析的属性测试


  - **属性 10: 页面范围解析正确性**
  - **验证需求: 3.2**

- [x] 3. 更新导航网站


- [x] 3.1 更新 tooles/index.html 中的 PDF 工具链接


  - 将 PDF 工具卡片中的链接指向实际的工具页面
  - 添加所有8个工具的链接（预览、合并、拆分、重排、水印、批注、转图片、压缩）
  - _需求: 9.1, 9.4_

- [x] 4. 实现 PDF 在线预览工具


- [x] 4.1 创建 pdf-preview.html 页面


  - 创建页面结构（头部、上传区、预览区、控制栏）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 1.1, 9.2, 10.4_

- [x] 4.2 实现 PDFPreviewTool 类

  - 初始化 FileUploader 和 PDFViewer
  - 实现文件上传处理逻辑
  - 实现错误处理（文件加载失败）
  - _需求: 1.1, 1.4, 1.5_

- [x] 4.3 编写 PDF 渲染的属性测试

  - **属性 1: PDF 渲染完整性**
  - **验证需求: 1.1**

- [x] 4.4 编写文件切换的属性测试

  - **属性 4: 文件切换状态清理**
  - **验证需求: 1.5**

- [x] 5. 实现 PDF 合并工具


- [x] 5.1 创建 pdf-merge.html 页面


  - 创建页面结构（头部、上传区、文件列表、合并按钮）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 2.1, 9.2, 10.4_

- [x] 5.2 实现 PDFMergeTool 类

  - 实现多文件上传和列表显示
  - 实现文件缩略图预览
  - 实现拖拽排序功能
  - 实现文件删除功能
  - 实现 PDF 合并逻辑（使用 pdf-lib）
  - 实现合并后的文件下载
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 5.3 编写文件列表显示的属性测试

  - **属性 5: 文件列表显示一致性**
  - **验证需求: 2.1**

- [x] 5.4 编写 PDF 合并的属性测试

  - **属性 7: PDF 合并页面保持性**
  - **验证需求: 2.3**

- [x] 5.5 编写文件删除的属性测试

  - **属性 8: 文件删除列表更新**
  - **验证需求: 2.5**

- [x] 6. 实现 PDF 拆分工具


- [x] 6.1 创建 pdf-split.html 页面

  - 创建页面结构（头部、上传区、页面范围输入、预览区、导出按钮）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 3.1, 9.2, 10.4_

- [x] 6.2 实现 PDFSplitTool 类

  - 实现 PDF 加载和页面信息显示
  - 实现页面范围输入验证
  - 实现页面提取逻辑（使用 pdf-lib）
  - 实现提取后的文件下载
  - 实现错误处理（无效范围、页码超出）
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 6.3 编写页面信息显示的属性测试

  - **属性 9: 页面信息准确性**
  - **验证需求: 3.1**

- [x] 6.4 编写页面提取的属性测试

  - **属性 11: 页面提取数量一致性**
  - **验证需求: 3.4**

- [x] 7. 实现 PDF 页面删除与重排工具


- [x] 7.1 创建 pdf-reorder.html 页面

  - 创建页面结构（头部、上传区、缩略图网格、保存按钮）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 4.1, 9.2, 10.4_

- [x] 7.2 实现 PDFReorderTool 类

  - 实现 PDF 加载和缩略图生成
  - 实现页面选择和删除功能
  - 实现拖拽重排功能
  - 实现新 PDF 生成逻辑（使用 pdf-lib）
  - 实现错误处理（删除所有页面）
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 7.3 编写缩略图生成的属性测试

  - **属性 12: 缩略图数量一致性**
  - **验证需求: 4.1**

- [x] 7.4 编写页面删除的属性测试

  - **属性 13: 页面删除数量减少**
  - **验证需求: 4.2**

- [x] 7.5 编写页面重排的属性测试

  - **属性 15: 重排后页面保持性**
  - **验证需求: 4.4**

- [x] 8. 检查点 - 确保所有测试通过

  - 确保所有测试通过，如有问题请询问用户

- [x] 9. 实现 PDF 文字水印工具


- [x] 9.1 创建 pdf-watermark.html 页面

  - 创建页面结构（头部、上传区、水印配置面板、预览区、应用按钮）
  - 添加水印配置控件（文字、字体大小、颜色、透明度、位置）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 5.1, 9.2, 10.4_

- [x] 9.2 实现 PDFWatermarkTool 类

  - 实现 PDF 加载
  - 实现水印配置更新逻辑
  - 实现实时预览功能
  - 实现水印应用逻辑（使用 Canvas 和 pdf-lib）
  - 实现带水印的文件下载
  - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 9.3 编写水印预览的属性测试

  - **属性 17: 水印预览实时性**
  - **验证需求: 5.2, 5.3**

- [x] 9.4 编写水印应用的属性测试

  - **属性 18: 水印应用全局性**
  - **验证需求: 5.4**

- [x] 10. 实现 PDF 批注工具


- [x] 10.1 创建 pdf-annotate.html 页面

  - 创建页面结构（头部、上传区、工具栏、画布区、保存按钮）
  - 添加批注工具栏（文字批注、高亮、下划线）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 6.1, 9.2, 10.4_

- [x] 10.2 实现 PDFAnnotateTool 类

  - 实现 PDF 加载和 Canvas 渲染
  - 实现工具选择逻辑
  - 实现文字批注添加功能
  - 实现高亮添加功能
  - 实现批注删除功能
  - 实现带批注的 PDF 保存（使用 Canvas 和 pdf-lib）
  - _需求: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 10.3 编写批注创建的属性测试

  - **属性 20: 批注创建响应性**
  - **验证需求: 6.2, 6.3**

- [x] 10.4 编写批注删除的属性测试

  - **属性 21: 批注删除数量减少**
  - **验证需求: 6.5**

- [x] 11. 实现 PDF 转图片工具


- [x] 11.1 创建 pdf-to-image.html 页面

  - 创建页面结构（头部、上传区、格式选择、页面选择区、导出按钮）
  - 添加格式选择控件（JPG、PNG）
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库（包括 JSZip）
  - _需求: 7.1, 9.2, 10.4_

- [x] 11.2 实现 PDFToImageTool 类

  - 实现 PDF 加载和页面预览
  - 实现格式选择逻辑
  - 实现页面选择功能
  - 实现 PDF 到图片的转换（使用 Canvas）
  - 实现单页下载和多页 ZIP 打包下载
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 11.3 编写页面选择的属性测试

  - **属性 23: 页面选择导出一致性**
  - **验证需求: 7.3**

- [x] 11.4 编写图片格式的属性测试

  - **属性 24: 图片格式转换正确性**
  - **验证需求: 7.4**

- [x] 11.5 编写多页打包的属性测试

  - **属性 25: 多页导出打包性**
  - **验证需求: 7.5**

- [x] 12. 实现 PDF 压缩工具


- [x] 12.1 创建 pdf-compress.html 页面

  - 创建页面结构（头部、上传区、质量选择、文件信息显示、压缩按钮）
  - 添加压缩质量选择控件（低、中、高）
  - 添加文件大小显示区域
  - 添加返回导航网站的链接
  - 添加隐私保护说明
  - 引入共享样式和库
  - _需求: 8.1, 9.2, 10.4_

- [x] 12.2 实现 PDFCompressTool 类

  - 实现 PDF 加载和文件信息显示
  - 实现压缩质量选择逻辑
  - 实现压缩大小估算功能
  - 实现 PDF 压缩逻辑（通过 Canvas 重绘）
  - 实现压缩结果显示（文件大小、压缩比例）
  - 实现压缩后的文件下载
  - _需求: 8.1, 8.2, 8.3, 8.4, 8.5_

- [x] 12.3 编写压缩功能的属性测试

  - **属性 27: 压缩文件大小减少**
  - **验证需求: 8.3**

- [x] 13. 实现隐私保护和网络隔离


- [x] 13.1 在所有工具页面添加隐私说明

  - 在每个页面顶部添加 "所有处理均在本地完成，不上传到服务器" 的说明
  - _需求: 10.4_

- [x] 13.2 确保所有处理都在客户端完成

  - 检查所有代码，确保没有向外部服务器发送文件数据
  - 实现页面卸载时的内存清理
  - _需求: 10.1, 10.2, 10.3_

- [x] 13.3 编写网络隔离的属性测试

  - **属性 29: 客户端处理隔离性**
  - **验证需求: 10.1, 10.2, 10.5**

- [x] 13.4 编写数据清理的属性测试

  - **属性 30: 页面刷新数据清理**
  - **验证需求: 10.3**

- [x] 14. 优化和完善


- [x] 14.1 统一所有页面的视觉风格

  - 确保所有工具页面使用一致的颜色、字体、布局
  - 与导航网站保持视觉一致性
  - _需求: 9.3_

- [x] 14.2 添加响应式设计

  - 确保所有工具页面在移动设备上正常显示
  - 调整布局以适应不同屏幕尺寸
  - _需求: 9.5_

- [x] 14.3 优化性能

  - 实现大文件的分块处理
  - 添加处理进度显示
  - 优化缩略图生成性能
  - _需求: 2.3, 3.4, 4.1_

- [x] 14.4 完善错误处理

  - 确保所有错误场景都有友好的错误提示
  - 添加浏览器兼容性检测
  - _需求: 1.4, 3.3, 4.5_

- [x] 15. 最终检查点 - 确保所有测试通过


  -确保所有测试通过,如有问题请询问用户

- [x] 16. 修复 PDF 水印工具的中文字符编码问题




- [x] 16.1 修复 WinAnsi 编码错误



  - 在 pdf-watermark.html 中嵌入支持中文的字体
  - 使用 pdf-lib 的 embedFont 方法嵌入标准字体或自定义字体
  - 确保水印文字支持中文、日文等非 ASCII 字符
  - _需求: 5.1, 5.4_

- [x] 17. 优化 PDF 批注工具的用户体验




- [x] 17.1 增加多页预览和滚动功能




  - 修改 pdf-annotate.html 以显示所有页面而不仅是第一页
  - 添加垂直滚动容器以支持多页浏览
  - 增大文字批注的默认字体大小以提高可读性
  - 为每一页添加页码标识
  - _需求: 6.1, 6.2_

- [x] 18. 为 PDF 转图片工具添加页面选择功能




- [x] 18.1 实现页面范围选择界面



  - 在 pdf-to-image.html 中添加页面范围输入框
  - 支持页面范围格式（如 "1-3, 5, 7-9"）
  - 复用 Utils.parsePageRange() 函数进行页面范围解析
  - 显示所有页面的缩略图供用户选择
  - 添加"全选"和"取消全选"按钮
  - _需求: 7.3_

- [x] 19. 优化 PDF 压缩工具的压缩效果





- [x] 19.1 改进压缩算法



  - 实现基于 Canvas 重绘的真实压缩功能
  - 根据选择的质量级别（低/中/高）调整图片压缩参数
  - 对 PDF 中的图片进行重新采样和压缩
  - 确保不同质量级别产生明显不同的文件大小
  - 显示压缩前后的文件大小对比
  - _需求: 8.2, 8.3, 8.4_